<template>
  <cve-player
    application-name="HdecUnrealPinglu"
    aspect-ratio="auto"
    level-name="Madao"
    scene-name="Base"
    :use-mic="false"
    :volume="0.3"
    @connect="onConnect"
    @debug="onDebug"
    @reject="onReject"
  >
  </cve-player>
</template>

<script setup lang="ts">
import '@cve-ts/player'
import { CameraControl, type CameraData } from '@cve-ts/controls'

const camera = new CameraControl()

async function onConnect(evt: CustomEvent<number>) {
  console.warn('[cve] connect ===> ', evt.detail)

  setTimeout(() => {
    const data: CameraData = {
      Location: [-150933.81522, -23069.396282, 25299.628117],
      Rotation: [0, -25.206932, -68.69767],
      ArmLength: 182103.671875,
    }
    camera.flyTo(data, 3)
  }, 1000 * 3)
}

interface DebugDetail {
  ui?: unknown
}
function onDebug(evt: CustomEvent<DebugDetail>) {
  if (evt.detail?.ui) {
    console.warn('[cve] debug ui ===> ', evt.detail.ui)
  }
}

function onReject(evt: CustomEvent<string>) {
  console.error('[cve] reject ===> ', evt.detail)
}
</script>

<style>
cve-player {
  height: 100vh;
  width: 100vw;
}
</style>
